<div class="modal-overlay" *ngIf="isOpen && cliente" (click)="onOverlayClick($event)">
  <div class="modal-container">
    <div class="modal-header">
      <h2 class="modal-title">Detalhes do Cliente</h2>
      <button class="modal-close" (click)="fecharModal()" aria-label="Fechar">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
          <path d="M18 6L6 18M6 6L18 18" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        </svg>
      </button>
    </div>

    <div class="modal-body">
      <!-- Header com informações principais -->
      <div class="detail-section">
        <div class="detail-header">
          <svg class="detail-icon" width="48" height="48" viewBox="0 0 48 48" fill="none">
            <circle cx="24" cy="24" r="22" fill="#E0F2FE" stroke="#3B82F6" stroke-width="2"/>
            <circle cx="24" cy="18" r="6" stroke="#3B82F6" stroke-width="2" fill="none"/>
            <path d="M12 38C12 32 16 28 24 28C32 28 36 32 36 38" stroke="#3B82F6" stroke-width="2" stroke-linecap="round"/>
          </svg>
          <div class="detail-header-info">
            <h3 class="detail-name">{{ cliente.nome }}</h3>
            <!--  Status agora vem do cartão separado -->
            <span class="detail-badge" [ngClass]="getStatusClass(cartao?.status || '')">
              {{ getStatusTexto(cartao?.status || '') }}
            </span>
          </div>
        </div>
      </div>

      <!-- Informações Pessoais -->
      <div class="section-title">Informações Pessoais</div>
      <div class="detail-grid">
        <div class="detail-item">
          <label class="detail-label">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
              <rect x="2" y="4" width="12" height="8" rx="1" stroke="#6B7280" stroke-width="1.5" fill="none"/>
              <path d="M2 7H14M5 4V2M11 4V2" stroke="#6B7280" stroke-width="1.5" stroke-linecap="round"/>
            </svg>
            CPF
          </label>
          <p class="detail-value">{{ formatarCPF(cliente.cpf) }}</p>
        </div>

        <div class="detail-item">
          <label class="detail-label">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
              <rect x="2" y="3" width="12" height="10" rx="2" stroke="#6B7280" stroke-width="1.5" fill="none"/>
              <path d="M2 6H14M5 3V1M11 3V1" stroke="#6B7280" stroke-width="1.5" stroke-linecap="round"/>
              <circle cx="8" cy="9" r="1.5" fill="#6B7280"/>
            </svg>
            Email
          </label>
          <p class="detail-value">{{ cliente.email }}</p>
        </div>

        <div class="detail-item">
          <label class="detail-label">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
              <circle cx="8" cy="8" r="6" stroke="#6B7280" stroke-width="1.5" fill="none"/>
              <path d="M8 4V8L11 11" stroke="#6B7280" stroke-width="1.5" stroke-linecap="round"/>
            </svg>
            Data de Nascimento
          </label>
          <p class="detail-value">{{ cliente.dataNasc }}</p>
        </div>

        <div class="detail-item">
          <label class="detail-label">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
              <path d="M8 2L2 5V10C2 12 4.5 13.5 8 14C11.5 13.5 14 12 14 10V5L8 2Z" stroke="#6B7280" stroke-width="1.5" fill="none"/>
            </svg>
            ID do Cliente
          </label>
          <p class="detail-value">#{{ cliente.id }}</p>
        </div>
      </div>

      <!--  Seção de Endereço adicionada -->
      <div class="section-title">Endereço</div>
      <div class="detail-grid">
        <div class="detail-item">
          <label class="detail-label">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
              <path d="M8 2C5.8 2 4 3.8 4 6C4 9 8 14 8 14C8 14 12 9 12 6C12 3.8 10.2 2 8 2Z" stroke="#6B7280" stroke-width="1.5" fill="none"/>
              <circle cx="8" cy="6" r="1.5" fill="#6B7280"/>
            </svg>
            CEP
          </label>
          <p class="detail-value">{{ formatarCEP(cliente.endereco.cep) }}</p>
        </div>

        <div class="detail-item">
          <label class="detail-label">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
              <path d="M2 6L8 2L14 6V13C14 13.5 13.5 14 13 14H3C2.5 14 2 13.5 2 13V6Z" stroke="#6B7280" stroke-width="1.5" fill="none"/>
              <path d="M6 14V9H10V14" stroke="#6B7280" stroke-width="1.5"/>
            </svg>
            Rua
          </label>
          <p class="detail-value">{{ cliente.endereco.rua }}</p>
        </div>

        <div class="detail-item">
          <label class="detail-label">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
              <rect x="3" y="3" width="10" height="10" rx="1" stroke="#6B7280" stroke-width="1.5" fill="none"/>
              <path d="M6 6H10M6 9H10" stroke="#6B7280" stroke-width="1.5" stroke-linecap="round"/>
            </svg>
            Número
          </label>
          <p class="detail-value">{{ cliente.endereco.numero }}</p>
        </div>

        <div class="detail-item">
          <label class="detail-label">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
              <circle cx="8" cy="8" r="6" stroke="#6B7280" stroke-width="1.5" fill="none"/>
              <path d="M8 5V8L10 10" stroke="#6B7280" stroke-width="1.5" stroke-linecap="round"/>
            </svg>
            Bairro
          </label>
          <p class="detail-value">{{ cliente.endereco.bairro }}</p>
        </div>

        <div class="detail-item">
          <label class="detail-label">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
              <path d="M8 14C11.3 14 14 11.3 14 8C14 4.7 11.3 2 8 2C4.7 2 2 4.7 2 8C2 11.3 4.7 14 8 14Z" stroke="#6B7280" stroke-width="1.5" fill="none"/>
              <path d="M8 2V14M2 8H14" stroke="#6B7280" stroke-width="1.5"/>
            </svg>
            Cidade
          </label>
          <p class="detail-value">{{ cliente.endereco.cidade }}</p>
        </div>

        <div class="detail-item" *ngIf="cliente.endereco.complemento">
          <label class="detail-label">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
              <path d="M3 8L8 3L13 8M4 7V13H12V7" stroke="#6B7280" stroke-width="1.5" fill="none" stroke-linecap="round"/>
            </svg>
            Complemento
          </label>
          <p class="detail-value">{{ cliente.endereco.complemento }}</p>
        </div>
      </div>

      <div class="section-title">Conta</div>
      <div class="detail-grid">
        <div class="detail-item">
          <label class="detail-label">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
              <path d="M8 2C5.8 2 4 3.8 4 6C4 9 8 14 8 14C8 14 12 9 12 6C12 3.8 10.2 2 8 2Z" stroke="#6B7280" stroke-width="1.5" fill="none"/>
              <circle cx="8" cy="6" r="1.5" fill="#6B7280"/>
            </svg>
            Agencia
          </label>
          <p class="detail-value">{{cliente.conta.agencia}}</p>
        </div>

        <div class="detail-item">
          <label class="detail-label">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
              <path d="M2 6L8 2L14 6V13C14 13.5 13.5 14 13 14H3C2.5 14 2 13.5 2 13V6Z" stroke="#6B7280" stroke-width="1.5" fill="none"/>
              <path d="M6 14V9H10V14" stroke="#6B7280" stroke-width="1.5"/>
            </svg>
            tipo de Conta
          </label>
          <p class="detail-value">{{ cliente.conta.tipo }}</p>
        </div>
      </div>
        <div class="detail-item">
          <label class="detail-label">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
              <rect x="3" y="3" width="10" height="10" rx="1" stroke="#6B7280" stroke-width="1.5" fill="none"/>
              <path d="M6 6H10M6 9H10" stroke="#6B7280" stroke-width="1.5" stroke-linecap="round"/>
            </svg>
            saldo
          </label>
          <p class="detail-value">{{ formatarValorParaReal(cliente.conta.saldo!) }}</p>
        </div>

      <!--  Seção de Cartão adicionada (se existir) -->
      <div *ngIf="cartao">
        <div class="section-title">Informações do Cartão</div>
        <div class="detail-grid">
          <div class="detail-item">
            <label class="detail-label">
              <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                <rect x="2" y="4" width="12" height="8" rx="1.5" stroke="#6B7280" stroke-width="1.5" fill="none"/>
                <path d="M2 7H14" stroke="#6B7280" stroke-width="1.5"/>
              </svg>
              Número do Cartão
            </label>
            <p class="detail-value">{{ formatarNumeroCartao(cartao.numero) }}</p>
          </div>

          <div class="detail-item">
            <label class="detail-label">
              <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                <circle cx="8" cy="8" r="6" stroke="#6B7280" stroke-width="1.5" fill="none"/>
                <path d="M8 4V8L11 11" stroke="#6B7280" stroke-width="1.5" stroke-linecap="round"/>
            </svg>
              Data de Vencimento
            </label>
            <p class="detail-value">{{ cartao.dataVencimento }}</p>
          </div>

          <div class="detail-item">
            <label class="detail-label">
              <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                <rect x="3" y="3" width="10" height="10" rx="1" stroke="#6B7280" stroke-width="1.5" fill="none"/>
                <path d="M6 6H10M6 9H8" stroke="#6B7280" stroke-width="1.5" stroke-linecap="round"/>
              </svg>
              Tipo de Cartão
            </label>
            <p class="detail-value">{{ cartao.tipoCartao }}</p>
          </div>

          <div class="detail-item">
            <label class="detail-label">
              <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                <circle cx="8" cy="8" r="6" stroke="#6B7280" stroke-width="1.5" fill="none"/>
                <path d="M8 10V14M8 6V7" stroke="#6B7280" stroke-width="1.5" stroke-linecap="round"/>
              </svg>
              Status do Cartão
            </label>
            <p class="detail-value">{{ getStatusTexto(cartao.status) }}</p>
          </div>
        </div>

        <div class="detail-info-box">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
            <circle cx="10" cy="10" r="8" stroke="#3B82F6" stroke-width="2" fill="none"/>
            <path d="M10 10V14M10 6V7" stroke="#3B82F6" stroke-width="2" stroke-linecap="round"/>
          </svg>
          <p class="detail-info-text">
            Este cartão está atualmente com status <strong>{{ getStatusTexto(cartao.status) }}</strong>.
            Você pode alterar o status diretamente na lista de clientes.
          </p>
        </div>
      </div>

      <!--  Mensagem quando não há cartão -->
      <div *ngIf="!cartao" class="detail-info-box info-warning">
        <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
          <path d="M10 2L2 18H18L10 2Z" stroke="#F59E0B" stroke-width="2" fill="none"/>
          <path d="M10 8V12M10 14V15" stroke="#F59E0B" stroke-width="2" stroke-linecap="round"/>
        </svg>
        <p class="detail-info-text">
          Este cliente ainda não possui um cartão associado.
        </p>
      </div>
    </div>

    <div class="modal-footer">
        <button class="btn-secondary" (click)="exportarPDF()">
            Exportar PDF
        </button>
        <button class="btn-secondary" (click)="exportarXML()">
            Exportar XML
        </button>
        <button class="btn-secondary" (click)="fecharModal()">
            Fechar
        </button>
    </div>
  </div>
</div>
